<NODE export_version="0.5" nodetype="nodelet" title="Node Bucket">
  <field name="author_user" type="noderef" type_nodetype="user,nodetype">root</field>
  <field name="authoraccess" type="literal_value">iiii</field>
  <field name="dynamicauthor_permission" type="literal_value">-1</field>
  <field name="dynamicgroup_permission" type="literal_value">-1</field>
  <field name="dynamicguest_permission" type="literal_value">-1</field>
  <field name="dynamicother_permission" type="literal_value">-1</field>
  <field name="group_usergroup" type="literal_value">-1</field>
  <field name="groupaccess" type="literal_value">iiii-</field>
  <field name="guestaccess" type="literal_value">iiii-</field>
  <field name="loc_location" type="noderef" type_nodetype="location,nodetype">nodelet</field>
  <field name="mini_nodelet" type="literal_value">0</field>
  <field name="nlcode" type="literal_value">[%
return "" unless($NODE->hasAccess($USER, "w"));

my $PARAMS = { op => 'addBucket', "bnode_" . $$NODE{node_id} => 1 };
linkNode($NODE, "Add '$$NODE{title}'", $PARAMS);
%]

[%
$query->start_multipart_form("POST", $ENV{script_name}) .
$query->hidden("displaytype") .
$query->hidden("node_id", $$NODE{node_id}) .
$query->hidden(-name => "op", -default => "bucketop", -override => 1);
%]

[%
my @bnodes;
@bnodes = split ',', $$VARS{nodebucket} if (defined($$VARS{nodebucket}));
my $isLoc = $NODE->isOfType("location");
my $isGroup = $NODE->isGroup();
my $str;

return "Empty&lt;br>\n" unless(@bnodes);

foreach $_ (@bnodes)
{
  my $node = getNode $_;

  # Can't use CGI::checkbox here because it insists on having a label...
  $str .= "&lt;INPUT TYPE='checkbox' NAME='bnode_$_' " .
     "VALUE='ON' UNCHECKED>";
  $str .= linkNode($node) . "&lt;br>\n";
}

$str .= "&lt;font size=1>\n";

$str .= "&lt;INPUT TYPE='checkbox' NAME='dropexec' VALUE='ON' CHECKED>" .
  "Execute and drop&lt;br>\n" if($isLoc or $isGroup);

if($isLoc)
{
  $str .= $query->submit( -name => "bmove", -value => "Move" ) . "\n";
  $str .= $query->submit( -name => "bsymlink", -value => "Symlink" ) . "\n";
}
elsif($isGroup)
{
  $str .= $query->submit( -name => "bgroupadd", -value => "Add to Group") ."\n";
}

$str .= $query->submit( -name => "bdrop", -value => "Drop" ) . "\n";

$str .= "&lt;/font>\n";

$str;
%]
&lt;/form>
</field>
  <field name="nlgoto" type="literal_value">0</field>
  <field name="nltext" type="literal_value">&lt;A HREF="/index.pl?bnode_65=1&amp;lastnode_id=65&amp;op=addBucket&amp;node_id=65">Add 'Gigantic Node Lister'&lt;/a>

&lt;form method="post" action="/index.pl?lastnode_id=65&amp;node_id=65&amp;displaytype=edit" enctype="multipart/form-data">
&lt;input type="hidden" name="displaytype" value="edit">&lt;input type="hidden" name="node_id" value="65">&lt;input type="hidden" name="op" value="bucketop">

&lt;INPUT TYPE='checkbox' NAME='bnode_285' VALUE='ON' UNCHECKED>&lt;A HREF="/index.pl?lastnode_id=65&amp;node_id=285">crap&lt;/a>&lt;br>
&lt;font size=1>
&lt;input type="submit" name="bdrop" value="Drop" />
&lt;/font>

&lt;/form>
</field>
  <field name="otheraccess" type="literal_value">iiii-</field>
  <field name="parent_container" type="noderef" type_nodetype="container,nodetype">general nodelet container</field>
  <field name="title" type="literal_value">Node Bucket</field>
  <field name="type_nodetype" type="noderef" type_nodetype="nodetype,nodetype">nodelet</field>
  <field name="updateinterval" type="literal_value">0</field>
</NODE>
