<NODE export_version="0.5" nodetype="nodelet" title="Other Users Mini">
  <field type_nodetype="usergroup,nodetype" name="author_user" type="noderef">gods</field>
  <field name="authoraccess" type="literal_value">iiii</field>
  <field name="dynamicauthor_permission" type="literal_value">-1</field>
  <field name="dynamicgroup_permission" type="literal_value">-1</field>
  <field name="dynamicguest_permission" type="literal_value">-1</field>
  <field name="dynamicother_permission" type="literal_value">-1</field>
  <field name="group_usergroup" type="literal_value">-1</field>
  <field name="groupaccess" type="literal_value">iiii-</field>
  <field name="guestaccess" type="literal_value">iiii-</field>
  <field type_nodetype="location,nodetype" name="loc_location" type="noderef">nodelet</field>
  <field type_nodetype="nodelet,nodetype" name="mini_nodelet" type="noderef">Other Users</field>
  <field name="nlcode" type="literal_value">[%

my $time = 3 * 60;
my $limit = 30;

my $csr=$DB->getDatabaseHandle()->prepare("	
	SELECT node_id, title FROM node, user
	WHERE node_id=user_id and
	type_nodetype=". getId ($DB->getType('user')) ." and
	(UNIX_TIMESTAMP(now())-UNIX_TIMESTAMP(lasttime) &lt; $time)
	LIMIT $limit");

$csr->execute or return "SHIT";
my $str;
while(my $U = $csr->fetchrow_hashref) {
	$str .= linkNode($U, "&lt;font size=1 color=#FFFFFF> $$U{title} \;&lt;/font>");
}
$csr->finish;
return $str if $str;
"&lt;i>no users logged in&lt;/i>";
%] </field>
  <field name="nlgoto" type="literal_value">0</field>
  <field name="nltext" type="literal_value"></field>
  <field name="otheraccess" type="literal_value">iiii-</field>
  <field type_nodetype="container,nodetype" name="parent_container" type="noderef">general nodelet container</field>
  <field name="title" type="literal_value">Other Users Mini</field>
  <field type_nodetype="nodetype,nodetype" name="type_nodetype" type="noderef">nodelet</field>
  <field name="updateinterval" type="literal_value">0</field>
</NODE>
