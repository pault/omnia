<NODE><INFO>rendered by Everything::XML.pm</INFO>
	<author_user table="node" type="usergroup">gods</author_user>
	<code table="htmlcode">return if $$USER{title} eq "Guest User";

my $disp = $query-&gt;param("displaytype");
my @nodes;
my $str;

my $CLONER = getNode("node cloner", "restricted_superdoc");
my $PARAMS = { "srcnode_id" =&gt; $$NODE{node_id}, 
  "node_id" =&gt; $$CLONER{node_id},
  "newname" =&gt; "NEWNAME" };

my $url = urlGen($PARAMS);
my $script = "
&lt;script language=\"javascript\"&gt;

function cloneNode()
{
  var newname = prompt(\"Cloning node \\\"$$NODE{title}\\\"\\nEnter a new name:\", \"\");

  if(newname)
  {
    var url = $url;
    
    url = url.replace(/NEWNAME/, newname);
    url = url.replace(/ /g, \"%20\");
    parent.location = url;
  }
}

&lt;/script&gt;";

$str = $script;

$disp ||= "display";

# This will recurse up the nodetype inheritance hierarchy
# and find the appropriate display and edit pages for this
# node.
push @nodes, getPages($NODE);

foreach my $N (@nodes)
{
	if ($disp eq $$N{displaytype}){
		$str .= $$N{displaytype} ." ";
	} else {
		next if ($$N{displaytype} eq 'edit' and not canUpdateNode($USER, $NODE));
		$str .= linkNode ($NODE, $$N{displaytype}, {displaytype =&gt; $$N{displaytype}}) . " ";
	}
}

$str .= "&lt;a href='javascript: cloneNode();'&gt;clone&lt;/a&gt;";

# If a group editor is open, add a link to add this node to
# the group.  We will need to check if the nodegroup has
# a restriction on what nodetypes can be in the group.
if ($$VARS{group}) {
	my $GR = $DB-&gt;getNodeById($$VARS{group}, 'light');

	if(canUpdateNode($USER, $GR))
	{
		$str .=
"&lt;SCRIPT language=\"javascript\"&gt;
	function updateGroup() {
	window.open('" .
		urlGen({node_id =&gt; $$VARS{group},
			displaytype =&gt; 'editor',
			add =&gt; getId ($NODE)}, "noquotes") .
		"','". $$VARS{group} ."',
		'');	
	}
&lt;/SCRIPT&gt;
&lt;A href=\"javascript:updateGroup()\"&gt;add to &amp;quot;$$GR{title}&amp;quot;&lt;/a&gt;";
	}
}




$str.="\n&lt;SCRIPT language=\"javascript\"&gt;
       function confirmDelete(){
          if(confirm(\"Delete '$$NODE{title}'?\")){
		parent.location=" .
		urlGen({node_id=&gt;getId($NODE),op=&gt;"nuke"}) .
		"; }
        }
       &lt;/SCRIPT&gt;\n
	&lt;br&gt;&lt;font size=1&gt;
	&lt;a href='javascript: confirmDelete();'&gt;delete&lt;/a&gt;
	&lt;/font&gt;" 
			if(canDeleteNode($USER, $NODE));                                                                                          

$str;</code>
	<core table="node">R</core>
	<package table="node">0</package>
	<reputation table="node">0</reputation>
	<title table="node">adminbar</title>
	<type_nodetype table="node" type="nodetype">htmlcode</type_nodetype>
</NODE>