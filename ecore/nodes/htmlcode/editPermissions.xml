<NODE export_version="0.5" nodetype="htmlcode" title="editPermissions">
  <field type_nodetype="user,nodetype" name="author_user" type="noderef">root</field>
  <field name="authoraccess" type="literal_value">iiii</field>
  <field name="code" type="literal_value">use Everything::FormMenu;
my ($who, $default) = @_;
my $menu;
my $str;
my @menus;
my @perms;
my $field = "";

$field = "default" if($default);
$field .= $who . "access";

@perms = split '', $$NODE{$field};

for(my $i = 0; $i &lt; @perms; $i++)
{
  # We don't want to deal with the "create" case, if it
  # is not the nodetype defaults.
  next if($i == 4 &amp;&amp; not $default);

  my $options = { 'i' => "inherit", '-' => "disable" };
  my $name = $who;

  $name = "default_" . $name if($default);

  $menu = new Everything::FormMenu();
  # The order is always "rwxdc"
  if($i == 0)
  {
    $name .= "_read";
    $$options{r} = "read";
  }
  elsif($i == 1)
  {
    $name .= "_write";
    $$options{w} = "write";
  }
  elsif($i == 2)
  {
    $name .= "_exec";
    $$options{x} = "execute";
  }
  elsif($i == 3)
  {
    $name .= "_delete";
    $$options{d} = "delete";
  }
  elsif($i == 4)
  {
    $name .= "_create";
    $$options{c} = "create";
  }

  $menu->addHash($options);
  push @menus, $menu->writePopupHTML($query, $name, $perms[$i]);
}

$str = join "&lt;/td>\n&lt;td bgcolor=#999999>", @menus;

return $str;</field>
  <field name="dynamicauthor_permission" type="literal_value">-1</field>
  <field name="dynamicgroup_permission" type="literal_value">-1</field>
  <field name="dynamicguest_permission" type="literal_value">-1</field>
  <field name="dynamicother_permission" type="literal_value">-1</field>
  <field name="group_usergroup" type="literal_value">-1</field>
  <field name="groupaccess" type="literal_value">iiii-</field>
  <field name="guestaccess" type="literal_value">iiii-</field>
  <field type_nodetype="location,nodetype" name="loc_location" type="noderef">htmlcode</field>
  <field name="otheraccess" type="literal_value">iiii-</field>
  <field name="title" type="literal_value">editPermissions</field>
  <field type_nodetype="nodetype,nodetype" name="type_nodetype" type="noderef">htmlcode</field>
</NODE>
