<NODE export_version="0.5" nodetype="htmlcode" title="editPermissions">
  <field type="noderef" type_nodetype="user,nodetype" name="author_user">root</field>
  <field type="literal_value" name="authoraccess">iiii</field>
  <field type="literal_value" name="code">use Everything::FormMenu;
my ($who, $default) = @_;
my $menu;
my $str;
my @menus;
my @perms;
my $field = "";

$field = "default" if($default);
$field .= $who . "access";

@perms = split '', $$NODE{$field};

for(my $i = 0; $i &lt; @perms; $i++)
{
  # We don't want to deal with the "create" case, if it
  # is not the nodetype defaults.
  next if($i == 4 &amp;&amp; not $default);

  my $options = { 'i' => "inherit", '-' => "disable" };
  my $name = $who;

  $name = "default_" . $name if($default);

  $menu = new Everything::FormMenu();
  # The order is always "rwxdc"
  if($i == 0)
  {
    $name .= "_read";
    $$options{r} = "read";
  }
  elsif($i == 1)
  {
    $name .= "_write";
    $$options{w} = "write";
  }
  elsif($i == 2)
  {
    $name .= "_exec";
    $$options{x} = "execute";
  }
  elsif($i == 3)
  {
    $name .= "_delete";
    $$options{d} = "delete";
  }
  elsif($i == 4)
  {
    $name .= "_create";
    $$options{c} = "create";
  }

  $menu->addHash($options);
  push @menus, $menu->writePopupHTML($query, $name, $perms[$i]);
}

$str = join "&lt;/td>\n&lt;td bgcolor=#999999>", @menus;

return $str;</field>
  <field type="literal_value" name="dynamicauthor_permission">-1</field>
  <field type="literal_value" name="dynamicgroup_permission">-1</field>
  <field type="literal_value" name="dynamicguest_permission">-1</field>
  <field type="literal_value" name="dynamicother_permission">-1</field>
  <field type="literal_value" name="group_usergroup">-1</field>
  <field type="literal_value" name="groupaccess">iiii-</field>
  <field type="literal_value" name="guestaccess">iiii-</field>
  <field type="noderef" type_nodetype="location,nodetype" name="loc_location">htmlcode</field>
  <field type="literal_value" name="otheraccess">iiii-</field>
  <field type="literal_value" name="title">editPermissions</field>
  <field type="noderef" type_nodetype="nodetype,nodetype" name="type_nodetype">htmlcode</field>
</NODE>
