<NODE export_version="0.5" nodetype="superdoc" title="What is my password">
  <field type="noderef" type_nodetype="user,nodetype" name="author_user">root</field>
  <field type="literal_value" name="authoraccess">iiii</field>
  <field type="literal_value" name="doctext">[%
  my $str;
  $str.="Forgot your username or password? All we need is one of the following blanks filled in correctly and you should be able to find the answers to your most perplexing question";
  $str.=$query->start_form("POST", $ENV{SCRIPT_NAME});
  $str.='&lt;INPUT TYPE="hidden" NAME="op" VALUE="lostpasswd">';
  $str.=$query->hidden('node_id',getId($NODE));
  $str.="Your username:";
  $str.='&lt;INPUT TYPE="text" NAME="username" VALUE="">&lt;br>';
  $str.="Your e-mail address:";
  $str.='&lt;INPUT TYPE="text" NAME="email" VALUE="">&lt;br>';
  $str.=$query->submit("sexisgood", "Mail me my password, Cowboy!");
  $str.=$query->end_form;


  if($query->param('op') eq 'lostpasswd' and ($query->param('username') || $query->param('email'))){
      my $haverow=0;
      my $username=$query->param('username');
      my $email=$query->param('email');
      my @N;
      if($username){
          @N = getNode($username, getType('user'));
          $haverow=$N[0];
      }
      if(!$haverow and $email){
          @N=$DB->getNodeWhere ({email => $email}, $DB->getType('user'));    
          $haverow=$N[0];
      }
      if($haverow){
         my ($n) = getNode('Password Mail', getType('mail'));
         $$n{doctext} =~ s/\&lt;name\>/$$haverow{realname}/;
         $$n{doctext} =~ s/\&lt;user\>/$$haverow{title}/;
         $$n{doctext} =~ s/\&lt;passwd\>/$$haverow{passwd}/;
         $$n{doctext} =~ s/\&lt;site_name\>/$HTMLVARS{site_name}/;
         $$n{doctext} =~ s/\&lt;site_url\>/$HTMLVARS{site_url}/;
         use Everything::MAIL;
         node2mail($$haverow{email},$n);
         $n = getNodeById(getId($n), 'force');
         $str.="&lt;BR>&lt;H3>Your password and username should be on its way&lt;/H3>";
      }
      else{
         $str="&lt;B>Couldn't find any info that matched what you gave us, make sure you typed in everything correctly!&lt;/B>&lt;BR>&lt;BR>".$str;
      }
  }
  $str;
%]</field>
  <field type="literal_value" name="dynamicauthor_permission">-1</field>
  <field type="literal_value" name="dynamicgroup_permission">-1</field>
  <field type="literal_value" name="dynamicguest_permission">-1</field>
  <field type="literal_value" name="dynamicother_permission">-1</field>
  <field type="literal_value" name="group_usergroup">-1</field>
  <field type="literal_value" name="groupaccess">iiii-</field>
  <field type="literal_value" name="guestaccess">iiii-</field>
  <field type="noderef" type_nodetype="location,nodetype" name="loc_location">superdoc</field>
  <field type="literal_value" name="otheraccess">iiii-</field>
  <field type="literal_value" name="title">What is my password</field>
  <field type="noderef" type_nodetype="nodetype,nodetype" name="type_nodetype">superdoc</field>
</NODE>
